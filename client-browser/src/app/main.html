<div class="main-container">
  <fountain-header></fountain-header>
  <main class="main container">

    <br>
    <md-card>
      <h2>Pacientes</h2>
      <div class="row">
        <div class="col-md-12">
          <md-input-container class="example-full-width">
            <input mdInput [(ngModel)]="searchPatient" placeholder="Pesquisar..."
                   (valueChanged)="selectPatient($event)"
                   auto-complete [source]="getPatients.bind(this)"
                   [list-formatter]="patientAutocompleteListFormatter"
                   value-property-name="id"
                   display-property-name="name"
                   no-match-found-text="Nenhum paciente encontrado."
                   accept-user-input="false"
                   loading-text="Carregando..."
                   max-num-list="10">
          </md-input-container>
        </div>
      </div>
    </md-card>

    <br>
    <form (ngSubmit)="savePatient()">
      <md-card>
          <h2>Ficha do Paciente
            <md-spinner class="card-spinner" mode="indeterminate" *ngIf="isLoading"></md-spinner>
          </h2>
          <div class="card-item-menu">
            <button type="button" md-icon-button [mdMenuTriggerFor]="menu">
              <md-icon>more_vert</md-icon>
            </button>
            <md-menu #menu="mdMenu">
              <button type="button" md-menu-item (click)="removePatient()">
                <md-icon>close</md-icon>
                <span>Remover Ficha</span>
              </button>
            </md-menu>
          </div>
          <div class="row">
            <div class="col-md-9">
              <md-input-container class="example-full-width">
                  <input mdInput name="name" placeholder="Nome" [(ngModel)]="patient.name" required>
              </md-input-container>
            </div>
            <div class="col-md-3">
              <!--<md-select class="example-full-width select-padding" placeholder="Convênio" [(ngModel)]="patient.medicalInsurance" name="medicalInsurance">
                <md-option *ngFor="let c of medicalInsurances" [value]="c.value">
                  {{c.name}}
                </md-option>
              </md-select>-->
              <md-input-container class="example-full-width">
                  <input mdInput name="medicalInsurance" placeholder="Convênio" [(ngModel)]="patient.medicalInsurance" required>
              </md-input-container>
            </div>
            <div class="col-md-9">
              <md-input-container class="example-full-width">
                <input mdInput name="address" placeholder="Endereço" [(ngModel)]="patient.address">
              </md-input-container>
            </div>
            <div class="col-md-3">
              <md-input-container class="example-full-width">
                <input mdInput name="taxIdNumber" placeholder="CPF" [(ngModel)]="patient.taxIdNumber">
              </md-input-container>
            </div>
            <div class="col-md-9">
              <md-input-container class="example-full-width">
                  <input mdInput name="email" type="email" placeholder="Email" [(ngModel)]="patient.email">
              </md-input-container>
            </div>
            <div class="col-md-3">
              <md-input-container class="example-full-width col-padding">
                  <input mdInput name="lastAppointment" placeholder="Última Consulta" [(ngModel)]="patient.lastAppointment" ngui-datetime-picker>
              </md-input-container>
            </div>
            <div class="col-md-9">
              <md-input-container class="example-full-width">
                  <input mdInput name="phoneNumber" type="tel" placeholder="Telefone/Celular" [(ngModel)]="patient.phoneNumber">
              </md-input-container>
            </div>
            <div class="col-md-3">
              <md-input-container class="example-full-width col-padding">
                  <input mdInput name="birthDate" placeholder="D.N." [(ngModel)]="patient.birthDate" ngui-datetime-picker date-only="true">
              </md-input-container>
            </div>
            <div class="col-md-12">
              <md-input-container class="example-full-width">
                <input mdInput name="accountablePerson" placeholder="Responsável" [(ngModel)]="patient.accountablePerson">
              </md-input-container>
            </div>
          </div>
          <div class="example-button-row">
              <button type="submit" md-fab color="primary" [disabled]="isLoading"><md-icon>check</md-icon></button>
          </div>
      </md-card>
    </form>

    <br>
    <form (ngSubmit)="savePatient()">
      <md-card>
        <div class="row">
          <div class="col-md-12">
            <h2>Observações</h2>
            <md-input-container class="example-full-width">
              <textarea mdInput name="observations" placeholder="Notas" [(ngModel)]="patient.observations" rows="4"></textarea>
            </md-input-container>
          </div>
          <div class="col-md-12">
            <h2>Receita Médica</h2>
            <md-input-container class="example-full-width">
              <textarea mdInput name="medicalReceipt" [(ngModel)]="patient.medicalReceipt" rows="4"></textarea>
            </md-input-container>
          </div>
        </div>
        <div class="example-button-row">
          <button type="submit" md-fab color="primary" [disabled]="isLoading"><md-icon>check</md-icon></button>
        </div>
      </md-card>
    </form>

    <br>
    <form>
      <md-card>
        <div class="row">
          <div class="col-md-12">
            <h2>Importar pacientes</h2>
            <input type="file" name="files" (change)="onUploadPatientsSubmit($event)" multiple accept=".csv"/>
          </div>
        </div>
      </md-card>
    </form>

    <br>

  </main>

  <!--<fountain-footer></fountain-footer>-->
</div>
